{"version":3,"file":"a11y-center.js","sourceRoot":"","sources":["../../src/a11y-center.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\nimport styles from \"./styles/index.css\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport { layout } from \"./templates/layout\";\nimport { a11yBar } from \"./templates/a11y-bar\";\nimport { defaultA11ySettings } from \"./settings/defaults\";\nimport {\n  A11ySettings,\n  A11ySelections,\n} from \"./settings/types\";\nimport { FontSizeSettings } from \"./modules/fontSize\";\nimport { FontFamilySettings } from \"./modules/fontFamily\";\nimport { mergeSettings, generateDynamicCSS } from \"./utils\";\n\n@customElement(\"a11y-center\")\nexport class a11yCenter extends LitElement {\n  static styles = [styles];\n  private uniqueIdPrefix: string = \"\";\n  private activeTrigger: HTMLElement | null = null;\n\n  private selections!: A11ySelections;\n  private defaultSelections!: A11ySelections;\n\n  @property({ type: String })\n  header = \"Accessibility Center\";\n\n  @property({ type: Object })\n  settings: A11ySettings = defaultA11ySettings;\n\n  private mergedSettings!: A11ySettings;\n\n  constructor() {\n    super();\n    this.uniqueIdPrefix = uuidv4().slice(0, 9);\n    this.injectStylesheet();\n    this.addTriggerListeners();\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.updateMergedSettings();\n    this.buildSelectionObj();\n    this.addTriggerListeners();\n    document.addEventListener(\"keydown\", this.trapFocus);\n  }\n\n  updated(changedProperties: Map<string | number | symbol, unknown>) {\n    if (changedProperties.has('settings')) {\n      this.updateMergedSettings();\n      this.buildSelectionObj();\n    }\n  }\n\n  updateMergedSettings() {\n    this.mergedSettings = mergeSettings(this.settings);\n    generateDynamicCSS(this.mergedSettings.fontSize as FontSizeSettings, 'font-size');\n    generateDynamicCSS(this.mergedSettings.fontFamily as FontFamilySettings, 'font-family');\n  }\n\n  buildSelectionObj() {\n    this.selections = {};\n\n    // Initialize selections with default values from settings\n    if (\n      this.mergedSettings.fontSize &&\n      typeof this.mergedSettings.fontSize !== \"boolean\"\n    ) {\n      this.selections.fontSize =\n        this.mergedSettings.fontSize.default?.label ?? \"\";\n    }\n\n    if (\n      this.mergedSettings.fontFamily &&\n      typeof this.mergedSettings.fontFamily !== \"boolean\"\n    ) {\n      this.selections.fontFamily =\n        this.mergedSettings.fontFamily.default?.label ?? \"\";\n    }\n\n    // Save default selections\n    this.defaultSelections = { ...this.selections };\n\n    // Retrieve saved selections from localStorage\n    const saved = JSON.parse(\n      localStorage.getItem(this.mergedSettings.saveAs ?? \"a11y-center\") || \"{}\"\n    );\n\n    // Update selections with any values from the saved object\n    this.selections = { ...this.selections, ...saved };\n\n    this.applySelections(this.selections);\n  }\n\n  resetSelections() {\n    // Reset selections to default values\n    this.selections = { ...this.defaultSelections };\n    this.applySelections(this.selections);\n    this.saveSelectionsLocally();\n  }\n\n  applySelections(selections: A11ySelections) {\n    // Apply selections\n    if (selections.fontSize)\n      this.updateFontSizeSetting(this.selections.fontSize, false);\n    if (selections.fontFamily)\n      this.updateFontFamilySetting(this.selections.fontFamily, false);\n  }\n\n  injectStylesheet() {\n    // Inject the stylesheet into the document head\n    const stylesheet = document.createElement(\"style\");\n    stylesheet.type = \"text/css\";\n    stylesheet.id = \"a11y-center-styles\";\n    stylesheet.textContent = styles.toString();\n    document.head.appendChild(stylesheet);\n  }\n\n  createRenderRoot() {\n    return this;\n  }\n\n  render() {\n    return html`\n      ${layout(\n        a11yBar(\n          this.closeA11yCenter,\n          this.mergedSettings,\n          this.selections,\n          this.updateFontSizeSetting,\n          this.updateFontFamilySetting,\n          this.resetSelections\n        ),\n        this.header,\n        \"a11y-bar open\"\n      )}\n    `;\n  }\n\n  updateFontSizeSetting = (option: string, save: boolean = true) => {\n    // Update the font size setting\n    document.documentElement.setAttribute(\"data-a11y-font-size\", option);\n    this.selections.fontSize = option;\n    this.requestUpdate(); // Ensure the component updates\n    if (save) this.saveSelectionsLocally();\n  };\n\n  updateFontFamilySetting = (option: string, save: boolean = true) => {\n    // Update the font family setting\n    document.documentElement.setAttribute(\"data-a11y-font-family\", option);\n    this.selections.fontFamily = option;\n    this.requestUpdate(); // Ensure the component updates\n    if (save) this.saveSelectionsLocally();\n  }\n\n  saveSelectionsLocally() {\n    localStorage.setItem(\n      this.mergedSettings.saveAs ?? \"a11y-center\",\n      JSON.stringify(this.selections)\n    );\n  }\n\n  addTriggerListeners() {\n    // Add event listeners to all elements with the data-a11y-trigger attribute\n    const triggers = document.querySelectorAll(\"[data-a11y-trigger]\");\n    triggers.forEach((trigger) => {\n      trigger.setAttribute(\"aria-controls\", \"a11y-center\");\n      trigger.setAttribute(\"aria-expanded\", \"false\");\n      trigger.addEventListener(\"click\", this.toggleA11yCenter);\n    });\n  }\n\n  toggleA11yCenter = (event: Event) => {\n    const trigger = event.currentTarget as HTMLElement;\n    this.activeTrigger = trigger;\n\n    this.toggleVisibility();\n  };\n\n  closeA11yCenter = () => {\n    const a11yCenterElement = document.getElementById(\"a11y-center\");\n    if (a11yCenterElement) {\n      a11yCenterElement.setAttribute(\"aria-hidden\", \"true\");\n      a11yCenterElement.style.display = \"none\";\n      if (this.activeTrigger) {\n        this.activeTrigger.setAttribute(\"aria-expanded\", \"false\");\n        this.activeTrigger.focus();\n      }\n    }\n  };\n\n  toggleVisibility() {\n    const a11yCenterElement = document.getElementById(\"a11y-center\");\n    if (a11yCenterElement) {\n      const isVisible =\n        a11yCenterElement.getAttribute(\"aria-hidden\") === \"false\";\n      if (isVisible) {\n        this.closeA11yCenter();\n      } else {\n        a11yCenterElement.setAttribute(\"aria-hidden\", \"false\");\n        a11yCenterElement.style.display = \"flex\";\n        this.activeTrigger?.setAttribute(\"aria-expanded\", \"true\");\n        const firstFocusable = a11yCenterElement.querySelector<HTMLElement>(\n          'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n        );\n        firstFocusable?.focus();\n      }\n    }\n  }\n\n  trapFocus = (event: KeyboardEvent) => {\n    const a11yCenterElement = document.getElementById(\"a11y-center\");\n    if (\n      !a11yCenterElement ||\n      a11yCenterElement.getAttribute(\"aria-hidden\") === \"true\"\n    ) {\n      return;\n    }\n\n    const focusableElements = a11yCenterElement.querySelectorAll<HTMLElement>(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    );\n    const firstElement = focusableElements[0];\n    const lastElement = focusableElements[focusableElements.length - 1];\n\n    if (event.key === \"Tab\") {\n      if (event.shiftKey) {\n        // Shift + Tab\n        if (document.activeElement === firstElement) {\n          lastElement.focus();\n          event.preventDefault();\n        }\n      } else {\n        // Tab\n        if (document.activeElement === lastElement) {\n          firstElement.focus();\n          event.preventDefault();\n        }\n      }\n    } else if (event.key === \"Escape\") {\n      // Close the modal on Esc\n      this.closeA11yCenter();\n    }\n  };\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"a11y-center\": a11yCenter;\n  }\n}\n"]}